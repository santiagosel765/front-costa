<nz-card [nzTitle]="title" [nzExtra]="actionsTpl">
  <app-data-table
    [columns]="tableColumns"
    [data]="rows()"
    [loading]="loading()"
    [error]="error()"
    [total]="total()"
    [pageIndex]="tableState.snapshot.page"
    [pageSize]="tableState.snapshot.size"
    [searchValue]="tableState.snapshot.q"
    [searchPlaceholder]="'Buscar en ' + title.toLowerCase()"
    (pageChange)="onPageChange($event)"
    (searchChange)="onSearchChange($event)"
    (action)="handleAction($event)"
  ></app-data-table>
</nz-card>

<ng-template #actionsTpl>
  <button *ngIf="canWrite()" nz-button nzType="primary" (click)="openCreate()">{{ createLabel }}</button>
</ng-template>

<nz-modal
  [nzVisible]="isModalVisible()"
  [nzTitle]="editingId() ? 'Editar' : 'Nuevo'"
  [nzOkLoading]="loading()"
  (nzOnCancel)="closeModal()"
  (nzOnOk)="save()"
>
  <form [formGroup]="form" class="catalog-form">
    <ng-container *ngFor="let field of resolvedFields()">
      <label>{{ field.label }}</label>

      <ng-container [ngSwitch]="field.type">
        <textarea *ngSwitchCase="'textarea'" nz-input [formControlName]="field.key" rows="3"></textarea>
        <input *ngSwitchCase="'number'" nz-input type="number" [formControlName]="field.key" />
        <nz-switch *ngSwitchCase="'switch'" [formControlName]="field.key"></nz-switch>
        <input *ngSwitchDefault nz-input type="text" [formControlName]="field.key" />
      </ng-container>
    </ng-container>
  </form>
</nz-modal>
